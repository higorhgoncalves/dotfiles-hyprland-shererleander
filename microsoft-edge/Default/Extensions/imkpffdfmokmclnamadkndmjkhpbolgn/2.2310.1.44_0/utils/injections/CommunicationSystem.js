async function injectCommunicationSystem(){let e=(await chrome.runtime.sendMessage({action:"getAppName"})).res;window[e+"_communicationSystemInjected"]||(window[e+"_communicationSystemInjected"]=!0,document.addEventListener(e+"FetchEvent",(async t=>{let n=await chrome.runtime.sendMessage(t.detail);var o=new CustomEvent(e+"RespEvent_"+n.requestId,{detail:n});document.dispatchEvent(o)})),document.addEventListener(e+"_websiteFetchEvent",(async t=>{let n=await chrome.runtime.sendMessage(t.detail);var o=new CustomEvent(e+"_websiteRespEvent_"+n.requestId,{detail:n});document.dispatchEvent(o)})),chrome.runtime.onMessage.addListener(((e,t,n)=>(responseBuilder(n,window[e.action],e),!0))))}async function isWidgetInjected(){let e=(await chrome.runtime.sendMessage({action:"getAppName"})).res,t=document.querySelector("#"+e+"-widget-container");return null!==t&&(shadowRoot=t.shadowRoot,""!=shadowRoot.querySelector("#"+e+"-widget").innerHTML)}async function closeWidget(){let e=(await chrome.runtime.sendMessage({action:"getAppName"})).res;try{document.querySelector("#"+e+"-widget-container").remove()}catch{}}async function getGoshopRetailerId(){let e=document.querySelector("#extAffId");return null===e?null:e.value}function responseBuilder(e,t,n){t(n).then((t=>{e({res:t})}))}injectCommunicationSystem();