helpers.Api=class Api{async getRetailersList(){let t=await chrome.storage.local.get(["LastUpdate"]);if(void 0===t.LastUpdate||Date.now()-parseInt(t.LastUpdate)>TIME_BETWEEN_UPDATES){let t=BASE_URL+"/hooks/browserext/v2/?action=update_retailers",e=await fetch(t),a=await e.json(),o=a;trace("RETAILERS LIST UPDATED IN LOCAL STORAGE",a),chrome.storage.local.set({LastUpdate:Date.now()});let s=[];for(let t=0;t<o.length;t++)s[o[t].id]=o[t];o=s,chrome.storage.local.set({cashbackRetailersList:o})}let e=await chrome.storage.local.get(["cashbackRetailersList"]);return"{}"==JSON.stringify(e)?[]:await e.cashbackRetailersList}async updateDictionary(){let t=BASE_URL+"/hooks/browserext/v2/?action=get_dictionary",e=await fetch(t),a={data:await e.json(),lastUpdate:Date.now()};return trace("DICTIONARY UPDATED IN LOCAL STORAGE"),chrome.storage.local.set({dictionary:a}),a}async updateConfig(){let t=BASE_URL+"/hooks/browserext/v2/?action=get_ext_config",e=await fetch(t),a={data:await e.json(),lastUpdate:Date.now()};return trace("CONFIG UPDATED IN LOCAL STORAGE"),chrome.storage.local.set({config:a}),a}async getCouponForRetailer(t){let e=BASE_URL+"/hooks/browserext/v2/?action=get_coupon_for_retailer&id="+t,a=await fetch(e);return await a.json()}async getLoggedUser(){let t=await chrome.storage.local.get(["LastLoggedUserUpdate"]);if(void 0===t.LastLoggedUserUpdate||Date.now()-parseInt(t.LastLoggedUserUpdate)>TIME_BETWEEN_LOGGED_USER_UPDATES){trace("USER UPDATED IN LOCAL STORAGE");let t=BASE_URL+"/hooks/browserext/v2/?action=get_logged_user",e=await fetch(t),a=await e.json();chrome.storage.local.set({LastLoggedUserUpdate:Date.now()}),chrome.storage.local.set({loggedUser:a})}let e=await chrome.storage.local.get(["loggedUser"]);return"{}"==JSON.stringify(e)?[]:await e.loggedUser}async snitchExtensionsList(){let t=BASE_URL+"/hooks/browserext/v2/?action=snitching_ext_list",e=await chrome.management.getAll(),a={};for(let t=0;t<e.length;t++)a[e[t].id]=e[t].shortName;let o=await fetch(t,{method:"POST",body:JSON.stringify({exts_list:a})});await o.json()}async recommendShop(t){let e=BASE_URL+"/hooks/browserext/v2/?action=recommend_a_shop&shop_url="+encodeURIComponent(t),a=await fetch(e);return await a.json()}async snitchAction(t,e){let a=BASE_URL+"/hooks/browserext/v2/?action=snitching_action",o={user_action:t,action_value:e},s=await fetch(a,{method:"POST",body:JSON.stringify(o)});await s.json()}async snitchNoLog(t){let e=BASE_URL+"/hooks/browserext/v2/?action=snitching_no_log&message="+t,a=await fetch(e);await a.text()}async getCrps(){let t=BASE_URL+"/hooks/browserext/v2/?action=get_crps",e=await fetch(t),a=await e.json();console.log("CRPSSSSSS",a)}};